/*===-- test/test_vectors/md5.c ------------------------*- PUBLIC -*- C -*-===*/
/**
*** @file
*** @brief Test Vectors
***
*** Test vectors for the MD5 hash function.
**/
/*===----------------------------------------------------------------------===*/

#include "testenv.h"

/*===----------------------------------------------------------------------===*/

struct TEST_VECTOR
{
    const char *in;
    size_t in_len;
    const char *out;
    size_t out_len;
};

static const struct TEST_VECTOR tests[] =
{
{
    "", 0,
    "\xd4\x1d\x8c\xd9\x8f\x00\xb2\x04\xe9\x80\x09\x98\xec\xf8\x42\x7e", 16
},
{
    "a", 1,
    "\x0c\xc1\x75\xb9\xc0\xf1\xb6\xa8\x31\xc3\x99\xe2\x69\x77\x26\x61", 16
},
{
    "abc", 3,
    "\x90\x01\x50\x98\x3c\xd2\x4f\xb0\xd6\x96\x3f\x7d\x28\xe1\x7f\x72", 16
},
{
    "\x6d\x65\x73\x73\x61\x67\x65\x20\x64\x69\x67\x65\x73\x74", 14,
    "\xf9\x6b\x69\x7d\x7c\xb7\x93\x8d\x52\x5a\x2f\x31\xaa\xf1\x61\xd0", 16
},
{
    "abcdefghijklmnopqrstuvwxyz", 26,
    "\xc3\xfc\xd3\xd7\x61\x92\xe4\x00\x7d\xfb\x49\x6c\xca\x67\xe1\x3b", 16
},
{
    "abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq", 56,
    "\x82\x15\xef\x07\x96\xa2\x0b\xca\xaa\xe1\x16\xd3\x87\x6c\x66\x4a", 16
},
{
    "\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50"
    "\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x61\x62\x63\x64\x65\x66"
    "\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76"
    "\x77\x78\x79\x7a\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39", 62,
    "\xd1\x74\xab\x98\xd2\x77\xd9\xf5\xa5\x61\x1c\x2c\x9f\x41\x9d\x9f", 16
},
{
    "\x31\x32\x33\x34\x35\x36\x37\x38\x39\x30\x31\x32\x33\x34\x35\x36"
    "\x37\x38\x39\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x30\x31\x32"
    "\x33\x34\x35\x36\x37\x38\x39\x30\x31\x32\x33\x34\x35\x36\x37\x38"
    "\x39\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x30\x31\x32\x33\x34"
    "\x35\x36\x37\x38\x39\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x30", 80,
    "\x57\xed\xf4\xa2\x2b\xe3\xc9\x55\xac\x49\xda\x2e\x21\x07\xb6\x7a", 16
},
{
    "\x00", 1,
    "\x93\xb8\x85\xad\xfe\x0d\xa0\x89\xcd\xf6\x34\x90\x4f\xd5\x9f\x71", 16
},
{
    "\x00\x00", 2,
    "\xc4\x10\x3f\x12\x2d\x27\x67\x7c\x9d\xb1\x44\xca\xe1\x39\x4a\x66", 16
},
{
    "\x00\x00\x00", 3,
    "\x69\x3e\x9a\xf8\x4d\x3d\xfc\xc7\x1e\x64\x0e\x00\x5b\xdc\x5e\x2e", 16
},
{
    "\x00\x00\x00\x00", 4,
    "\xf1\xd3\xff\x84\x43\x29\x77\x32\x86\x2d\xf2\x1d\xc4\xe5\x72\x62", 16
},
{
    "\x00\x00\x00\x00\x00", 5,
    "\xca\x9c\x49\x1a\xc6\x6b\x2c\x62\x50\x08\x82\xe9\x3f\x37\x19\xa8", 16
},
{
    "\x00\x00\x00\x00\x00\x00", 6,
    "\x73\x19\x46\x88\x47\xd7\xb1\xae\xe4\x0d\xbf\x5d\xd9\x63\xc9\x99", 16
},
{
    "\x00\x00\x00\x00\x00\x00\x00", 7,
    "\xd3\x10\xa4\x04\x83\xf9\x39\x9d\xd7\xed\x17\x12\xe0\xfd\xd7\x02", 16
},
{
    "\x00\x00\x00\x00\x00\x00\x00\x00", 8,
    "\x7d\xea\x36\x2b\x3f\xac\x8e\x00\x95\x6a\x49\x52\xa3\xd4\xf4\x74", 16
},
{
    "\x00\x00\x00\x00\x00\x00\x00\x00\x00", 9,
    "\x3f\x28\x29\xb2\xff\xe8\x43\x4d\x67\xf9\x8a\x2a\x98\x96\x86\x52", 16
},
{
    "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00", 10,
    "\xa6\x3c\x90\xcc\x36\x84\xad\x8b\x0a\x21\x76\xa6\xa8\xfe\x90\x05", 16
},
{
    "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00", 11,
    "\x74\xda\x41\x21\xdc\x1c\x0e\xd2\xa8\xe5\xb0\x74\x1f\x82\x40\x34", 16
},
{
    "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00", 12,
    "\x8d\xd6\xbb\x73\x29\xa7\x14\x49\xb0\xa1\xb2\x92\xb5\x99\x91\x64", 16
},
{
    "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00", 13,
    "\x0b\x86\x7e\x53\xc1\xd2\x33\xce\x9f\xe4\x9d\x54\x54\x9a\x23\x23", 16
},
{
    "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00", 14,
    "\x36\xdf\x95\x40\xa5\xef\x49\x96\xa9\x73\x76\x57\xe4\xa8\x92\x9c", 16
},
{
    "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00", 15,
    "\x34\x49\xc9\xe5\xe3\x32\xf1\xdb\xb8\x15\x05\xcd\x73\x9f\xbf\x3f", 16
},
{
    "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00", 16,
    "\x4a\xe7\x13\x36\xe4\x4b\xf9\xbf\x79\xd2\x75\x2e\x23\x48\x18\xa5", 16
}
};

#define MAX_OUT_LEN 16

/*===----------------------------------------------------------------------===*/

static int check(const struct TEST_VECTOR *test)
{
    unsigned char out[MAX_OUT_LEN];
    struct HASH_STATE state;

    ASSERT_SUCCESS(hash_init(&state, HASH_MD5, 0));

    hash_update(&state, test->in, test->in_len);

    hash_final(&state, out);

    ASSERT_BUF_EQ(out, test->out, test->out_len);

    return 1;
}

int test_vectors_md5(void);
int test_vectors_md5(void)
{
    size_t t;

    if (!prim_avail(HASH_MD5))
        return 1;

    for (t = 0; t < ARRAY_SIZE(tests); ++t)
        if (!check(tests + t)) return 0;

    return 1;
}
