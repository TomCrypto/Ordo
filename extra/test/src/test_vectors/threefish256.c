/*===-- test/test_vectors/threefish256.c ---------------*- PUBLIC -*- C -*-===*/
/**
*** @file
*** @brief Test Vectors
***
*** Test vectors for the Threefish-256 block cipher.
**/
/*===----------------------------------------------------------------------===*/

#include "testenv.h"

/*===----------------------------------------------------------------------===*/

struct TEST_VECTOR
{
    const char *key;
    size_t key_len;
    const char *in;
    size_t in_len;
    const char *out;
    size_t out_len;
    int use_params;
    struct THREEFISH256_PARAMS params;
};

static const struct TEST_VECTOR tests[] =
{
{
    "\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f"
    "\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f", 32,
    "ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ\x01", 32,
    "\x93\xcb\x27\x5d\xe7\x2e\xb2\x86\x60\x3c\x47\xe0\x9d\x39\x1b\xf6"
    "\xa0\xf1\x60\xab\xe3\xba\x2e\xdb\x21\xd1\x11\xff\xee\xe6\xb2\xe6", 32
},
{
    "\x47\x36\xe9\xe3\xbf\xfa\x9c\x52\x0c\xef\x1b\xda\xed\x22\xdc\x91"
    "\xca\x64\x79\xf0\x81\x70\xdd\xf6\x16\xdb\xcc\xc8\xae\x12\xfa\x43", 32,
    "\x68\x07\xd2\x66\xa5\x26\xa2\xc6\x24\xbd\x57\x8d\x90\x9f\x95\xbe"
    "\x46\xfa\x6f\xde\x5e\xb8\x3a\xdf\x40\xc0\x7f\xff\x50\xee\x7c\x01", 32,
    "\xfe\x7b\x7b\x36\x02\xbb\xea\xde\x76\xa1\xa0\x8a\x0e\x8a\xc1\x43"
    "\xe4\x75\x93\x69\x56\x1c\x3d\x1c\x7c\x9b\x97\xe9\x82\xcf\xb6\xf8", 32
},
{
    "\x04\xe2\xb3\x2b\x0f\x05\x31\x5e\x16\x56\xd2\x78\x25\xd5\x8d\x8b"
    "\xb9\x27\xb5\xfc\x0e\x15\x9f\x18\x8f\x4a\x4c\xbc\x70\xf8\xe4\x3d", 32,
    "\xe4\x24\x17\xa2\x84\x31\x3c\xb4\xbe\x48\x02\xb3\xbe\x44\x7f\x62"
    "\x73\x9f\xa7\x03\x53\x40\x50\xe1\x60\xf0\xfc\x8e\xbf\xc3\x02\x01", 32,
    "\x66\xc3\xa3\x6c\x61\x7a\x33\x1b\x5e\x8d\x92\xe8\xae\xb1\xc3\xa5"
    "\x01\x20\x96\xee\x13\x55\x5b\x26\x63\x47\xf3\x29\xf6\x10\x69\x24", 32
},
{
    "\x37\x7c\x8b\x7d\xf9\xc4\xc3\xb6\xab\x08\x60\x39\x5a\x6f\x1f\xa7"
    "\xef\x83\x9a\x2d\xdd\x42\x6d\x73\x78\x21\x02\xb4\x9a\x33\x7e\x81", 32,
    "\x83\xc5\x9f\xdc\x09\xa4\xe7\x1a\x05\x16\xcf\xe9\x94\x07\xb0\xe9"
    "\x09\x25\xef\x84\xb6\x31\x14\x53\x2c\x4b\x2e\xdc\xf7\x81\xe1\x01", 32,
    "\xa2\x16\x91\x95\xeb\x54\x91\x50\xa9\xb9\x0d\x10\x32\x17\xb9\xb1"
    "\x93\x9c\x16\xf2\x03\xcb\x87\xff\x14\x0a\x32\xfe\x58\x1a\x92\x7b", 32
},
{
    "\xe1\xa1\x72\xb4\xb7\x5b\x71\x98\x5f\x73\xad\x6a\x9a\x6b\x3d\x87"
    "\x67\x62\xf1\x4c\xff\x2a\x4e\x01\x9c\x35\xf5\xe7\x1c\xb6\xd9\x0b", 32,
    "\x72\x06\xac\x5c\xb4\x7f\x1a\xbd\x12\xd7\xbf\xc1\xb5\x22\x2a\xcf"
    "\x46\x48\xe4\x18\x71\x45\x12\xbc\xf5\x9c\x8c\x08\x54\xf3\x61\x01", 32,
    "\xd6\xd4\x7f\x0b\x49\xac\x92\xb8\x51\x6c\x84\xea\xc4\xb3\xb6\x88"
    "\x69\x0e\xc9\xba\x23\x08\x56\x40\x8d\x41\x87\x82\x2c\xa8\x1b\x34", 32
},
{
    "\x26\x30\x85\x8b\xcc\x7a\x91\x8c\x0b\x6b\x83\xa0\xfd\x5d\x38\x71"
    "\xb0\xec\x8d\x31\x68\x39\x0d\xaf\x72\xd5\xee\x34\xe4\x0b\xf2\xa7", 32,
    "\x55\xda\xef\x3a\xb4\xc0\xb5\xd0\x0f\x4d\x31\x9d\x60\x89\xda\xda"
    "\xef\x36\x3a\xe3\x80\xd6\x6c\xc2\x89\xba\x07\x30\x1c\x52\x20\x01", 32,
    "\x55\xc1\x5e\x0d\x1a\xca\x34\x86\xb3\x0e\x64\x61\xff\xa1\xd0\x7b"
    "\x22\xd3\x9a\xe2\xa1\xda\x44\x06\x05\xfa\xef\x1a\xed\x55\x4a\xa1", 32
},
{
    "\xd5\x01\x37\x7b\x88\x9c\x7c\xf1\x84\x69\xdd\xc8\x40\x65\x5d\xa9"
    "\xc0\x9d\x84\xe9\x23\x12\xe9\xc0\x18\xdf\xb8\x50\xed\xfe\x6d\x0c", 32,
    "\xeb\x61\x91\x53\x34\xe9\x21\x26\xb7\xba\x75\x30\x8d\x75\x69\x2c"
    "\xdc\x08\xd5\x70\xf5\x57\x20\xbd\xde\xd6\x48\xba\x88\x75\x86\x01", 32,
    "\xac\xd4\x96\x2c\x66\x8e\x65\x9b\x92\x48\xc1\x7f\x6d\x13\xf8\x32"
    "\xf3\x83\xec\x1b\xd9\x3b\xb7\xe4\xf1\x64\x72\x04\x38\x66\xb8\x81", 32
},
{
    "\x9c\x67\x0c\xe7\x9a\x6b\x42\xb6\x87\x2f\x91\x37\x68\x00\x08\x47"
    "\x24\xdb\xbe\xf9\xc8\xc5\x54\x0e\xf7\xdf\x16\xae\x9e\x8a\x5f\x93", 32,
    "\x35\xd3\xbf\xbd\x2c\x0e\x3c\xa1\x11\xaa\xd9\x92\x7b\x9f\xd4\xc2"
    "\x8f\xfb\xff\xcb\x91\x06\xa7\x09\x40\x08\xd3\xea\xc9\x2e\x93\x01", 32,
    "\xa2\xfc\x86\x82\x72\xf5\x19\x1a\xcd\xca\x9a\xc5\x7f\x8f\x18\x69"
    "\xe2\x48\xc3\x65\xb3\x9e\xf2\x7e\xfa\x50\x2c\x52\xb6\x7d\xe1\xf7", 32
},
{
    "\x7f\x98\x6e\xa4\x56\x11\x28\xba\x94\x4f\x8c\x97\x62\x75\x5c\xbd"
    "\x7e\x7e\x01\x47\xa3\x2e\x65\x89\x17\x21\x5b\x74\x45\xff\x06\x4d", 32,
    "\xcd\x1f\x26\x8d\xf3\xd7\x36\x45\x23\x78\x51\x96\x4d\x9a\x30\xa7"
    "\x17\x1a\x1f\xd8\xe9\xc0\x4d\x7b\x6b\x20\x71\xc2\x41\x99\x64\x01", 32,
    "\xd6\xc2\x57\xa6\xf1\x24\x89\x22\xf8\x02\xd1\xd5\x0a\xc0\xca\xfd"
    "\x62\x74\x75\xb9\x91\xe4\xf6\xe5\x53\x2e\x57\x55\xa3\x1f\x58\xfa", 32
}
};

#define MAX_OUT_LEN 32

/*===----------------------------------------------------------------------===*/

static int check(const struct TEST_VECTOR *test)
{
    unsigned char out[MAX_OUT_LEN];
    struct BLOCK_STATE state;

    ASSERT_SUCCESS(block_init(&state, test->key, test->key_len,
                              BLOCK_THREEFISH256, test->use_params
                                                ? &test->params
                                                : 0));

    memcpy(out, test->in, test->in_len);

    block_forward(&state, out);

    ASSERT_BUF_EQ(out, test->out, test->out_len);

    block_inverse(&state, out);

    ASSERT_BUF_EQ(out, test->in, test->in_len);

    block_final(&state);

    return 1;
}

int test_vectors_threefish256(void);
int test_vectors_threefish256(void)
{
    size_t t;

    if (!prim_avail(BLOCK_THREEFISH256))
        return 1;

    for (t = 0; t < ARRAY_SIZE(tests); ++t)
        if (!check(tests + t)) return 0;

    return 1;
}
