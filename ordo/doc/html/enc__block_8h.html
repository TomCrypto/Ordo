<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Ordo: include/enc/enc_block.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Ordo
   &#160;<span id="projectnumber">2.0.0</span>
   </div>
   <div id="projectbrief">Symmetric Cryptography Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_5523b64a2c3f4540333752f1d0d12622.html">enc</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">enc_block.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Block cipher symmetric encryption.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;enc/block_modes.h&gt;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for enc_block.h:</div>
<div class="dyncontent">
<div class="center"><img src="enc__block_8h__incl.png" border="0" usemap="#include_2enc_2enc__block_8h" alt=""/></div>
<map name="include_2enc_2enc__block_8h" id="include_2enc_2enc__block_8h">
<area shape="rect" id="node3" href="block__modes_8h_source.html" title="enc/block_modes.h" alt="" coords="123,83,256,112"/><area shape="rect" id="node5" href="mode__params_8h_source.html" title="enc/block_cipher_modes\l/mode_params.h" alt="" coords="5,161,171,207"/><area shape="rect" id="node9" href="primitives_8h.html" title="Cryptographic primitives. " alt="" coords="216,169,365,199"/><area shape="rect" id="node14" href="block__params_8h_source.html" title="primitives/block_ciphers\l/block_params.h" alt="" coords="221,257,384,303"/><area shape="rect" id="node16" href="stream__params_8h_source.html" title="primitives/stream_ciphers\l/stream_params.h" alt="" coords="408,257,579,303"/><area shape="rect" id="node18" href="hash__params_8h_source.html" title="primitives/hash_functions\l/hash_params.h" alt="" coords="603,257,773,303"/></map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="enc__block_8h__dep__incl.png" border="0" usemap="#include_2enc_2enc__block_8hdep" alt=""/></div>
<map name="include_2enc_2enc__block_8hdep" id="include_2enc_2enc__block_8hdep">
<area shape="rect" id="node3" href="ordo_8h.html" title="Ordo high&#45;level API. " alt="" coords="36,83,137,112"/></map>
</div>
</div>
<p><a href="enc__block_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5663f6eb909948d2e548e6db9014b607"><td class="memItemLeft" align="right" valign="top">struct ENC_BLOCK_CTX *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="enc__block_8h.html#a5663f6eb909948d2e548e6db9014b607">enc_block_alloc</a> (struct BLOCK_CIPHER *cipher, struct BLOCK_MODE *mode)</td></tr>
<tr class="separator:a5663f6eb909948d2e548e6db9014b607"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a247e2923280b2802882d5fdcfa039083"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="enc__block_8h.html#a247e2923280b2802882d5fdcfa039083">enc_block_init</a> (struct ENC_BLOCK_CTX *ctx, void *key, size_t keySize, void *iv, int dir, void *cipherParams, void *modeParams)</td></tr>
<tr class="separator:a247e2923280b2802882d5fdcfa039083"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac3f73d8bc6bf4c9843a2e28ca718805"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="enc__block_8h.html#aac3f73d8bc6bf4c9843a2e28ca718805">enc_block_update</a> (struct ENC_BLOCK_CTX *ctx, void *in, size_t inlen, void *out, size_t *outlen)</td></tr>
<tr class="separator:aac3f73d8bc6bf4c9843a2e28ca718805"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acba3f213a3988cc61459e3410af3595d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="enc__block_8h.html#acba3f213a3988cc61459e3410af3595d">enc_block_final</a> (struct ENC_BLOCK_CTX *ctx, void *out, size_t *outlen)</td></tr>
<tr class="separator:acba3f213a3988cc61459e3410af3595d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a89a79795216c8c7eefc09116c9e40f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="enc__block_8h.html#a0a89a79795216c8c7eefc09116c9e40f">enc_block_free</a> (struct ENC_BLOCK_CTX *ctx)</td></tr>
<tr class="separator:a0a89a79795216c8c7eefc09116c9e40f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Block cipher symmetric encryption. </p>
<p>Interface to encrypt plaintext and decrypt ciphertext with different block ciphers and modes of operation. Note it is always possible to skip this API and directly use the lower-level functions available in the individual mode of operation headers, but this interface abstracts away some of the more boilerplate details and so should be preferred.</p>
<p>If you wish to use the lower level API, you will need to manage your block cipher contexts yourself, which can give more flexibility in some particular cases but is often unnecessary.</p>
<p>The padding algorithm for modes of operation which use padding is PKCS7 (RFC 5652), which appends N bytes of value N, where N is the number of padding bytes required, in bytes (between 1 and the block cipher's block size).</p>
<dl class="section see"><dt>See Also</dt><dd>enc_block.c </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a5663f6eb909948d2e548e6db9014b607"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct ENC_BLOCK_CTX* enc_block_alloc </td>
          <td>(</td>
          <td class="paramtype">struct BLOCK_CIPHER *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct BLOCK_MODE *&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function returns an allocated block cipher encryption context using a specific block cipher and mode of operation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cipher</td><td>The block cipher object to be used. </td></tr>
    <tr><td class="paramname">mode</td><td>The mode of operation object to be used. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the allocated block cipher encryption context, or 0 if an error occurred. </dd></dl>

</div>
</div>
<a class="anchor" id="a247e2923280b2802882d5fdcfa039083"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int enc_block_init </td>
          <td>(</td>
          <td class="paramtype">struct ENC_BLOCK_CTX *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keySize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cipherParams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>modeParams</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function initializes a block cipher encryption context for encryption, provided a key, initialization vector, and cipher/mode-specific parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>An allocated block cipher encryption context. </td></tr>
    <tr><td class="paramname">key</td><td>A buffer containing the key to use for encryption. </td></tr>
    <tr><td class="paramname">keySize</td><td>The size, in bytes, of the encryption key. </td></tr>
    <tr><td class="paramname">iv</td><td>This points to the initialization vector. </td></tr>
    <tr><td class="paramname">cipherParams</td><td>This points to specific cipher parameters, set to zero for default behavior. </td></tr>
    <tr><td class="paramname">modeParams</td><td>This points to specific mode of operation parameters, set to zero for default behavior. </td></tr>
    <tr><td class="paramname">dir</td><td>This represents the dir of encryption, set to 1 for encryption and 0 for decryption. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns <code>ORDO_SUCCESS</code> on success, and a negative value on error. </dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>The initialization vector may be zero, if the mode of operation does not require one. </dd></dl>

</div>
</div>
<a class="anchor" id="aac3f73d8bc6bf4c9843a2e28ca718805"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void enc_block_update </td>
          <td>(</td>
          <td class="paramtype">struct ENC_BLOCK_CTX *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>inlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>outlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function encrypts or decrypts a buffer of a given length using the provided block cipher encryption context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The block cipher encryption context to use. This context must have been allocated and initialized. </td></tr>
    <tr><td class="paramname">in</td><td>This points to a buffer containing plaintext (or ciphertext). </td></tr>
    <tr><td class="paramname">inlen</td><td>This contains the size of the <code>in</code> buffer, in bytes. </td></tr>
    <tr><td class="paramname">out</td><td>This points to a buffer which will contain the plaintext (or ciphertext). </td></tr>
    <tr><td class="paramname">outlen</td><td>This points to a variable which will contain the number of bytes written to <code>out</code>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>See <code>blockEncryptModeUpdate()</code> for remarks about output buffer size. </dd></dl>

</div>
</div>
<a class="anchor" id="acba3f213a3988cc61459e3410af3595d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int enc_block_final </td>
          <td>(</td>
          <td class="paramtype">struct ENC_BLOCK_CTX *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>outlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function finalizes a block cipher encryption context, and will process and return any leftover plaintext or ciphertext. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The block cipher encryption context to use. This context must have been allocated and initialized. </td></tr>
    <tr><td class="paramname">out</td><td>This points to a buffer which will contain any remaining plaintext (or ciphertext). </td></tr>
    <tr><td class="paramname">outlen</td><td>This points to a variable which will contain the number of bytes written to <code>out</code>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns <code>ORDO_SUCCESS</code> on success, and a negative value on error. </dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>Once this function returns, the passed context can no longer be used for encryption or decryption. </dd>
<dd>
See <code>blockEncryptModeFinal()</code> for remarks. </dd></dl>

</div>
</div>
<a class="anchor" id="a0a89a79795216c8c7eefc09116c9e40f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void enc_block_free </td>
          <td>(</td>
          <td class="paramtype">struct ENC_BLOCK_CTX *&#160;</td>
          <td class="paramname"><em>ctx</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function frees (deallocates) an initialized block cipher encryption context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The block cipher encryption context to be freed. This context needs to at least have been allocated. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>Once this function returns, the passed context may no longer be used anywhere and sensitive information will be wiped. Do not call this function if <code><a class="el" href="enc__block_8h.html#a5663f6eb909948d2e548e6db9014b607">enc_block_alloc()</a></code> failed, as the latter correctly frees dangling context buffers in case of error. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Jun 22 2013 17:00:55 for Ordo by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.4
</small></address>
</body>
</html>
