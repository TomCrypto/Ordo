<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Ordo: /ssd/Ordo/include/ordo/primitives/block_modes/cbc.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Ordo
   &#160;<span id="projectnumber">2.7.1</span>
   </div>
   <div id="projectbrief">Symmetric Cryptography Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d123810ffc52040794f0e98a285358dc.html">Ordo</a></li><li class="navelem"><a class="el" href="dir_0d02763f569ebb2bad671cc2bd02e294.html">include</a></li><li class="navelem"><a class="el" href="dir_c00beb2f47f1a372281af19e94b4f2ce.html">ordo</a></li><li class="navelem"><a class="el" href="dir_462de7c1e1b35dcbd41187fa92c0aa0f.html">primitives</a></li><li class="navelem"><a class="el" href="dir_5a395bdf872b98cb8426cf4ab5142def.html">block_modes</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">cbc.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Primitive.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="mode__params_8h_source.html">ordo/primitives/block_modes/mode_params.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="block__ciphers_8h_source.html">ordo/primitives/block_ciphers.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for cbc.h:</div>
<div class="dyncontent">
<div class="center"><img src="cbc_8h__incl.png" border="0" usemap="#_2ssd_2_ordo_2include_2ordo_2primitives_2block__modes_2cbc_8h" alt=""/></div>
<map name="_2ssd_2_ordo_2include_2ordo_2primitives_2block__modes_2cbc_8h" id="_2ssd_2_ordo_2include_2ordo_2primitives_2block__modes_2cbc_8h">
<area shape="rect" id="node3" href="mode__params_8h.html" title="Primitive Parameters. " alt="" coords="5,110,171,165"/><area shape="rect" id="node5" href="block__ciphers_8h.html" title="Abstraction Layer. " alt="" coords="195,110,336,165"/></map>
</div>
</div>
<p><a href="cbc_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2bb27dd68226219613aafe7cfb40651a"><td class="memItemLeft" align="right" valign="top">ORDO_PUBLIC struct CBC_STATE *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cbc_8h.html#a2bb27dd68226219613aafe7cfb40651a">cbc_alloc</a> (const struct BLOCK_CIPHER *cipher, const void *cipher_state)</td></tr>
<tr class="separator:a2bb27dd68226219613aafe7cfb40651a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc9b81bc13933736175e1c2168fa583b"><td class="memItemLeft" align="right" valign="top">ORDO_PUBLIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cbc_8h.html#afc9b81bc13933736175e1c2168fa583b">cbc_init</a> (struct CBC_STATE *state, const struct BLOCK_CIPHER *cipher, const void *cipher_state, const void *iv, size_t iv_len, int dir, const struct <a class="el" href="struct_c_b_c___p_a_r_a_m_s.html">CBC_PARAMS</a> *params)</td></tr>
<tr class="separator:afc9b81bc13933736175e1c2168fa583b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a7bf6d1d061e23d52c9fba6f22bafe9"><td class="memItemLeft" align="right" valign="top">ORDO_PUBLIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cbc_8h.html#a9a7bf6d1d061e23d52c9fba6f22bafe9">cbc_update</a> (struct CBC_STATE *state, const struct BLOCK_CIPHER *cipher, const void *cipher_state, const unsigned char *in, size_t in_len, unsigned char *out, size_t *out_len)</td></tr>
<tr class="separator:a9a7bf6d1d061e23d52c9fba6f22bafe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0940fb5fe5836d9aa30beaa97a14dfb"><td class="memItemLeft" align="right" valign="top">ORDO_PUBLIC int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cbc_8h.html#aa0940fb5fe5836d9aa30beaa97a14dfb">cbc_final</a> (struct CBC_STATE *state, const struct BLOCK_CIPHER *cipher, const void *cipher_state, unsigned char *out, size_t *out_len)</td></tr>
<tr class="separator:aa0940fb5fe5836d9aa30beaa97a14dfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a131137f955ede69d67a188994abae201"><td class="memItemLeft" align="right" valign="top">ORDO_PUBLIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cbc_8h.html#a131137f955ede69d67a188994abae201">cbc_free</a> (struct CBC_STATE *state, const struct BLOCK_CIPHER *cipher, const void *cipher_state)</td></tr>
<tr class="separator:a131137f955ede69d67a188994abae201"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56fcff4b26709f1da901003a01c8df06"><td class="memItemLeft" align="right" valign="top">ORDO_PUBLIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cbc_8h.html#a56fcff4b26709f1da901003a01c8df06">cbc_copy</a> (struct CBC_STATE *dst, const struct CBC_STATE *src, const struct BLOCK_CIPHER *cipher)</td></tr>
<tr class="separator:a56fcff4b26709f1da901003a01c8df06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab30602ccfab5fdbb80989fd498b5af03"><td class="memItemLeft" align="right" valign="top">ORDO_PUBLIC size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cbc_8h.html#ab30602ccfab5fdbb80989fd498b5af03">cbc_query</a> (const struct BLOCK_CIPHER *cipher, int query, size_t value)</td></tr>
<tr class="separator:ab30602ccfab5fdbb80989fd498b5af03"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Primitive. </p>
<p>The CBC mode divides the input message into blocks of the cipher's block size, and encrypts them in a sequential fashion, where each block depends on the previous one (and the first block depends on the initialization vector). If the input message's length is not a multiple of the cipher's block size, a padding mechanism is enabled by default which will pad the message to the correct length (and remove the extra data upon decryption). If padding is explicitly disabled through the mode of operation's parameters, the input's length must be a multiple of the cipher's block size.</p>
<p>If padding is enabled, <code><a class="el" href="cbc_8h.html#aa0940fb5fe5836d9aa30beaa97a14dfb">cbc_final()</a></code> requires a valid pointer to be passed in the <code>outlen</code> parameter and will always return a full blocksize of data, containing the last few ciphertext bytes containing the padding information.</p>
<p>If padding is disabled, <code>outlen</code> is also required, and will return the number of unprocessed plaintext bytes in the context. If this is any value other than zero, the function will also fail with <code>ORDO_LEFTOVER</code>. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a2bb27dd68226219613aafe7cfb40651a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ORDO_PUBLIC struct CBC_STATE* cbc_alloc </td>
          <td>(</td>
          <td class="paramtype">const struct BLOCK_CIPHER *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>cipher_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section see"><dt>See Also</dt><dd><code><a class="el" href="block__modes_8h.html#ade67ab9197d15534c57c039b11771401">block_mode_alloc()</a></code> </dd></dl>

</div>
</div>
<a class="anchor" id="afc9b81bc13933736175e1c2168fa583b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ORDO_PUBLIC int cbc_init </td>
          <td>(</td>
          <td class="paramtype">struct CBC_STATE *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct BLOCK_CIPHER *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>cipher_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>iv_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="struct_c_b_c___p_a_r_a_m_s.html">CBC_PARAMS</a> *&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section see"><dt>See Also</dt><dd><code><a class="el" href="block__modes_8h.html#a5ccaf303c4a386f40dd958d1a3f18fc3">block_mode_init()</a></code> </dd></dl>

</div>
</div>
<a class="anchor" id="a9a7bf6d1d061e23d52c9fba6f22bafe9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ORDO_PUBLIC void cbc_update </td>
          <td>(</td>
          <td class="paramtype">struct CBC_STATE *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct BLOCK_CIPHER *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>cipher_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>in_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>out_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section see"><dt>See Also</dt><dd><code><a class="el" href="block__modes_8h.html#a8623000b40bdfdc5f4a8be4e0dea3f19">block_mode_update()</a></code> </dd></dl>

</div>
</div>
<a class="anchor" id="aa0940fb5fe5836d9aa30beaa97a14dfb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ORDO_PUBLIC int cbc_final </td>
          <td>(</td>
          <td class="paramtype">struct CBC_STATE *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct BLOCK_CIPHER *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>cipher_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>out_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section see"><dt>See Also</dt><dd><code><a class="el" href="block__modes_8h.html#a653015393bdff0ad14a4499823e51c40">block_mode_final()</a></code> </dd></dl>

</div>
</div>
<a class="anchor" id="a131137f955ede69d67a188994abae201"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ORDO_PUBLIC void cbc_free </td>
          <td>(</td>
          <td class="paramtype">struct CBC_STATE *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct BLOCK_CIPHER *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>cipher_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section see"><dt>See Also</dt><dd><code><a class="el" href="block__modes_8h.html#a560fe22ab979256386a7d3c3b0722e46">block_mode_free()</a></code> </dd></dl>

</div>
</div>
<a class="anchor" id="a56fcff4b26709f1da901003a01c8df06"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ORDO_PUBLIC void cbc_copy </td>
          <td>(</td>
          <td class="paramtype">struct CBC_STATE *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct CBC_STATE *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct BLOCK_CIPHER *&#160;</td>
          <td class="paramname"><em>cipher</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section see"><dt>See Also</dt><dd><code><a class="el" href="block__modes_8h.html#ad82d11b324d6d5afbbcf7d465f6827da">block_mode_copy()</a></code> </dd></dl>

</div>
</div>
<a class="anchor" id="ab30602ccfab5fdbb80989fd498b5af03"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ORDO_PUBLIC size_t cbc_query </td>
          <td>(</td>
          <td class="paramtype">const struct BLOCK_CIPHER *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section see"><dt>See Also</dt><dd><code><a class="el" href="block__modes_8h.html#a4a641f97ec68ac1e094cac24f1c3a250">block_mode_query()</a></code> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Apr 2 2014 15:33:15 for Ordo by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
