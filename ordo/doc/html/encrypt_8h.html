<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Ordo: include/encrypt/encrypt.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Ordo
   &#160;<span id="projectnumber">1.0.2</span>
   </div>
   <div id="projectbrief">Symmetric Cryptography Library</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_cfc40bcf945a94a5aced014fdc532bf3.html">include</a>      </li>
      <li class="navelem"><a class="el" href="dir_615fb381c39b1fe75df63295af649d42.html">encrypt</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">encrypt.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Symmetric encryption interface.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="primitives_8h_source.html">primitives/primitives.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="ordotypes_8h_source.html">common/ordotypes.h</a>&gt;</code><br/>
</div>
<p><a href="encrypt_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_e_n_c_r_y_p_t___m_o_d_e___c_o_n_t_e_x_t.html">ENCRYPT_MODE_CONTEXT</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Mode of operation context.  <a href="struct_e_n_c_r_y_p_t___m_o_d_e___c_o_n_t_e_x_t.html#details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_e_n_c_r_y_p_t_i_o_n___c_o_n_t_e_x_t.html">ENCRYPTION_CONTEXT</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Symmetric encryption context.  <a href="struct_e_n_c_r_y_p_t_i_o_n___c_o_n_t_e_x_t.html#details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encrypt_8h.html#ad5f952fd22b4a1b7c7a3c8b500d5b4e7">modeName</a>(m)</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encrypt_8h.html#a6e6e4647ccd20fe02479d188672b76d9">encryptLoad</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encrypt_8h.html#a5d27b7985a4ca3cb038ccb2ae6db78e2">encryptUnload</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">ENCRYPT_MODE *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encrypt_8h.html#ac59e354889d8718bd9172cbd3e3fc751">ECB</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">ENCRYPT_MODE *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encrypt_8h.html#a752f4415d0b3024c1dec8eea52c2900e">CBC</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">ENCRYPT_MODE *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encrypt_8h.html#adfede45252bf5e2cf63b28211464934e">CTR</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">ENCRYPT_MODE *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encrypt_8h.html#a6fd8764a62c406dc0e035c3913fffe51">CFB</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">ENCRYPT_MODE *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encrypt_8h.html#afd8c8bb303af625f34431caac6b797bf">OFB</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">ENCRYPT_MODE *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encrypt_8h.html#a433699e2fc9d0c997fc3c3f69ae4c6eb">STREAM</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">ENCRYPT_MODE *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encrypt_8h.html#a16dda56f8f7d72075bb4a00c788e1219">getEncryptMode</a> (char *name)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_e_n_c_r_y_p_t___m_o_d_e___c_o_n_t_e_x_t.html">ENCRYPT_MODE_CONTEXT</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encrypt_8h.html#a62d15c8ed396c52f2936813dc9d115ae">encryptModeCreate</a> (ENCRYPT_MODE *mode, <a class="el" href="struct_c_i_p_h_e_r___p_r_i_m_i_t_i_v_e___c_o_n_t_e_x_t.html">CIPHER_PRIMITIVE_CONTEXT</a> *cipher)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encrypt_8h.html#a07d91dc9b02722c52575a344f2cc018c">encryptModeInit</a> (<a class="el" href="struct_e_n_c_r_y_p_t___m_o_d_e___c_o_n_t_e_x_t.html">ENCRYPT_MODE_CONTEXT</a> *ctx, <a class="el" href="struct_c_i_p_h_e_r___p_r_i_m_i_t_i_v_e___c_o_n_t_e_x_t.html">CIPHER_PRIMITIVE_CONTEXT</a> *cipher, void *iv, void *modeParams, int direction)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encrypt_8h.html#a574243e97cb896e13dbd3e1cd1b264f4">encryptModeUpdate</a> (<a class="el" href="struct_e_n_c_r_y_p_t___m_o_d_e___c_o_n_t_e_x_t.html">ENCRYPT_MODE_CONTEXT</a> *ctx, <a class="el" href="struct_c_i_p_h_e_r___p_r_i_m_i_t_i_v_e___c_o_n_t_e_x_t.html">CIPHER_PRIMITIVE_CONTEXT</a> *cipher, unsigned char *in, size_t inlen, unsigned char *out, size_t *outlen)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encrypt_8h.html#a0ccb05403a59b12490380f57c20d72ff">encryptModeFinal</a> (<a class="el" href="struct_e_n_c_r_y_p_t___m_o_d_e___c_o_n_t_e_x_t.html">ENCRYPT_MODE_CONTEXT</a> *ctx, <a class="el" href="struct_c_i_p_h_e_r___p_r_i_m_i_t_i_v_e___c_o_n_t_e_x_t.html">CIPHER_PRIMITIVE_CONTEXT</a> *cipher, unsigned char *out, size_t *outlen)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encrypt_8h.html#ada8e8c1933363578b573bb270a78fa22">encryptModeFree</a> (<a class="el" href="struct_e_n_c_r_y_p_t___m_o_d_e___c_o_n_t_e_x_t.html">ENCRYPT_MODE_CONTEXT</a> *ctx, <a class="el" href="struct_c_i_p_h_e_r___p_r_i_m_i_t_i_v_e___c_o_n_t_e_x_t.html">CIPHER_PRIMITIVE_CONTEXT</a> *cipher)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_e_n_c_r_y_p_t_i_o_n___c_o_n_t_e_x_t.html">ENCRYPTION_CONTEXT</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encrypt_8h.html#a4383b4295ff553f245623483fa17b5ba">encryptCreate</a> (CIPHER_PRIMITIVE *primitive, ENCRYPT_MODE *mode)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encrypt_8h.html#a4fb43e9f859010383ff272dc19474c6a">encryptInit</a> (<a class="el" href="struct_e_n_c_r_y_p_t_i_o_n___c_o_n_t_e_x_t.html">ENCRYPTION_CONTEXT</a> *ctx, void *key, size_t keySize, void *iv, void *cipherParams, void *modeParams, int direction)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encrypt_8h.html#a413d2b02feb780526dc5f52dba2fbefe">encryptUpdate</a> (<a class="el" href="struct_e_n_c_r_y_p_t_i_o_n___c_o_n_t_e_x_t.html">ENCRYPTION_CONTEXT</a> *ctx, unsigned char *in, size_t inlen, unsigned char *out, size_t *outlen)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encrypt_8h.html#a6531497a158f60683a99ccdd27da4d05">encryptFinal</a> (<a class="el" href="struct_e_n_c_r_y_p_t_i_o_n___c_o_n_t_e_x_t.html">ENCRYPTION_CONTEXT</a> *ctx, unsigned char *out, size_t *outlen)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="encrypt_8h.html#a7280c0420eb580d9ccd49ef0ab0956d7">encryptFree</a> (<a class="el" href="struct_e_n_c_r_y_p_t_i_o_n___c_o_n_t_e_x_t.html">ENCRYPTION_CONTEXT</a> *ctx)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Symmetric encryption interface. </p>
<p>Exposes the Ordo symmetric encryption interface, to encrypt plaintext and decrypt ciphertext with different ciphers and modes of operation. Note it is always possible to skip this API and directly use the lower-level functions available in the individual cipher and mode of operation headers, but this interface abstracts away some of the more boilerplate details and so should be preferred.</p>
<p>If you wish to use the lower level API, you will need to manage your cipher primitive contexts yourself, which can give more flexibility in some cases but is usually unnecessary.</p>
<p>The padding algorithm is PKCS7 (RFC 5652), which appends N bytes of value N, where N is the number of padding bytes required (between 1 and the cipher's block size in bytes).</p>
<dl class="see"><dt><b>See also:</b></dt><dd>encrypt.c </dd></dl>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="ad5f952fd22b4a1b7c7a3c8b500d5b4e7"></a><!-- doxytag: member="encrypt.h::modeName" ref="ad5f952fd22b4a1b7c7a3c8b500d5b4e7" args="(m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="encrypt_8h.html#ad5f952fd22b4a1b7c7a3c8b500d5b4e7">modeName</a></td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the name of a mode of operation object. </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a6e6e4647ccd20fe02479d188672b76d9"></a><!-- doxytag: member="encrypt.h::encryptLoad" ref="a6e6e4647ccd20fe02479d188672b76d9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="encrypt_8h.html#a6e6e4647ccd20fe02479d188672b76d9">encryptLoad</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Loads all encryption modes of operation. This must be called (or the mode of operation objects must be initialized by some other means) before the ECB, CBC, etc... global variables can be used for encryption or decryption. </p>

</div>
</div>
<a class="anchor" id="a5d27b7985a4ca3cb038ccb2ae6db78e2"></a><!-- doxytag: member="encrypt.h::encryptUnload" ref="a5d27b7985a4ca3cb038ccb2ae6db78e2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="encrypt_8h.html#a5d27b7985a4ca3cb038ccb2ae6db78e2">encryptUnload</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Unloads all encryption modes of operation. After calling this, the ECB, CBC... mode of operation objects may no longer be used. </p>

</div>
</div>
<a class="anchor" id="ac59e354889d8718bd9172cbd3e3fc751"></a><!-- doxytag: member="encrypt.h::ECB" ref="ac59e354889d8718bd9172cbd3e3fc751" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ENCRYPT_MODE* <a class="el" href="encrypt_8h.html#ac59e354889d8718bd9172cbd3e3fc751">ECB</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The ECB (Electronic CodeBook) mode of operation. </p>

</div>
</div>
<a class="anchor" id="a752f4415d0b3024c1dec8eea52c2900e"></a><!-- doxytag: member="encrypt.h::CBC" ref="a752f4415d0b3024c1dec8eea52c2900e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ENCRYPT_MODE* <a class="el" href="encrypt_8h.html#a752f4415d0b3024c1dec8eea52c2900e">CBC</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The CBC (Ciphertext Block Chaining) mode of operation. </p>

</div>
</div>
<a class="anchor" id="adfede45252bf5e2cf63b28211464934e"></a><!-- doxytag: member="encrypt.h::CTR" ref="adfede45252bf5e2cf63b28211464934e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ENCRYPT_MODE* <a class="el" href="encrypt_8h.html#adfede45252bf5e2cf63b28211464934e">CTR</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The CTR (CounTeR) mode of operation. </p>

</div>
</div>
<a class="anchor" id="a6fd8764a62c406dc0e035c3913fffe51"></a><!-- doxytag: member="encrypt.h::CFB" ref="a6fd8764a62c406dc0e035c3913fffe51" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ENCRYPT_MODE* <a class="el" href="encrypt_8h.html#a6fd8764a62c406dc0e035c3913fffe51">CFB</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The CFB (Cipher FeedBack) mode of operation. </p>

</div>
</div>
<a class="anchor" id="afd8c8bb303af625f34431caac6b797bf"></a><!-- doxytag: member="encrypt.h::OFB" ref="afd8c8bb303af625f34431caac6b797bf" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ENCRYPT_MODE* <a class="el" href="encrypt_8h.html#afd8c8bb303af625f34431caac6b797bf">OFB</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The OFB (Output FeedBack) mode of operation. </p>

</div>
</div>
<a class="anchor" id="a433699e2fc9d0c997fc3c3f69ae4c6eb"></a><!-- doxytag: member="encrypt.h::STREAM" ref="a433699e2fc9d0c997fc3c3f69ae4c6eb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ENCRYPT_MODE* <a class="el" href="encrypt_8h.html#a433699e2fc9d0c997fc3c3f69ae4c6eb">STREAM</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The STREAM mode of operation (for stream ciphers only). </p>

</div>
</div>
<a class="anchor" id="a16dda56f8f7d72075bb4a00c788e1219"></a><!-- doxytag: member="encrypt.h::getEncryptMode" ref="a16dda56f8f7d72075bb4a00c788e1219" args="(char *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ENCRYPT_MODE* <a class="el" href="encrypt_8h.html#a16dda56f8f7d72075bb4a00c788e1219">getEncryptMode</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Gets an encryption mode object from a name. </p>

</div>
</div>
<a class="anchor" id="a62d15c8ed396c52f2936813dc9d115ae"></a><!-- doxytag: member="encrypt.h::encryptModeCreate" ref="a62d15c8ed396c52f2936813dc9d115ae" args="(ENCRYPT_MODE *mode, CIPHER_PRIMITIVE_CONTEXT *cipher)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_e_n_c_r_y_p_t___m_o_d_e___c_o_n_t_e_x_t.html">ENCRYPT_MODE_CONTEXT</a>* <a class="el" href="encrypt_8h.html#a62d15c8ed396c52f2936813dc9d115ae">encryptModeCreate</a> </td>
          <td>(</td>
          <td class="paramtype">ENCRYPT_MODE *&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_c_i_p_h_e_r___p_r_i_m_i_t_i_v_e___c_o_n_t_e_x_t.html">CIPHER_PRIMITIVE_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>cipher</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function returns an allocated encryption mode context using a specific mode of operation and initialized cipher context. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">mode</td><td>The mode of operation object to be used. </td></tr>
    <tr><td class="paramname">cipher</td><td>The cipher primitive context to use. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Returns the allocated encryption context, or 0 if an allocation error occurred. </dd></dl>

</div>
</div>
<a class="anchor" id="a07d91dc9b02722c52575a344f2cc018c"></a><!-- doxytag: member="encrypt.h::encryptModeInit" ref="a07d91dc9b02722c52575a344f2cc018c" args="(ENCRYPT_MODE_CONTEXT *ctx, CIPHER_PRIMITIVE_CONTEXT *cipher, void *iv, void *modeParams, int direction)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="encrypt_8h.html#a07d91dc9b02722c52575a344f2cc018c">encryptModeInit</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_e_n_c_r_y_p_t___m_o_d_e___c_o_n_t_e_x_t.html">ENCRYPT_MODE_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_c_i_p_h_e_r___p_r_i_m_i_t_i_v_e___c_o_n_t_e_x_t.html">CIPHER_PRIMITIVE_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>modeParams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function initializes an encryption mode context for encryption, provided an initialization vector and mode-specific parameters. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>An allocated encryption mode context. </td></tr>
    <tr><td class="paramname">cipher</td><td>The cipher primitive context to use. </td></tr>
    <tr><td class="paramname">iv</td><td>This points to the initialization vector. Note the length of the initialization vector is known to be the same as the block size of the cipher primitive associated with the provided encryption context. </td></tr>
    <tr><td class="paramname">modeParams</td><td>This contains mode-specific parameters, to enable or disable specific behavior. </td></tr>
    <tr><td class="paramname">direction</td><td>This represents the direction of encryption, set to 1 for encryption and 0 for decryption. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Returns <code>ORDO_ESUCCESS</code> on success, and a negative value on error. </dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>The initialization vector may be zero, if the mode of operation does not require one. </dd></dl>

</div>
</div>
<a class="anchor" id="a574243e97cb896e13dbd3e1cd1b264f4"></a><!-- doxytag: member="encrypt.h::encryptModeUpdate" ref="a574243e97cb896e13dbd3e1cd1b264f4" args="(ENCRYPT_MODE_CONTEXT *ctx, CIPHER_PRIMITIVE_CONTEXT *cipher, unsigned char *in, size_t inlen, unsigned char *out, size_t *outlen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="encrypt_8h.html#a574243e97cb896e13dbd3e1cd1b264f4">encryptModeUpdate</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_e_n_c_r_y_p_t___m_o_d_e___c_o_n_t_e_x_t.html">ENCRYPT_MODE_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_c_i_p_h_e_r___p_r_i_m_i_t_i_v_e___c_o_n_t_e_x_t.html">CIPHER_PRIMITIVE_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>inlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>outlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function encrypts or decrypts a buffer of a given length using the provided encryption mode context. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The encryption mode context to use. This context must have been allocated and initialized. </td></tr>
    <tr><td class="paramname">cipher</td><td>The cipher primitive context to use. </td></tr>
    <tr><td class="paramname">in</td><td>This points to a buffer containing plaintext (or ciphertext). </td></tr>
    <tr><td class="paramname">inlen</td><td>This contains the size of the in buffer, in bytes. </td></tr>
    <tr><td class="paramname">out</td><td>This points to a buffer which will contain the plaintext (or ciphertext). </td></tr>
    <tr><td class="paramname">outlen</td><td>This points to a variable which will contain the number of bytes written to out. </td></tr>
  </table>
  </dd>
</dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>The out buffer should have enough space to store the entire resulting ciphertext or plaintext If padding is not used or disabled, out may be exactly as large as in, but if padding is enabled, out needs to be sized appropriately either up to the nearest cipher block size (outlen strictly greater than inlen) for encryption, either down to the nearest cipher block size for decryption (outlen strictly less than inlen) for decryption. </dd>
<dd>
By design, the symmetric encryption API considers every buffer given to this function between an <code>encryptModeInit</code> and an <code>encryptModeFinal</code> call to be part of one large buffer, hence care must be taken to respect this assumption. </dd></dl>

</div>
</div>
<a class="anchor" id="a0ccb05403a59b12490380f57c20d72ff"></a><!-- doxytag: member="encrypt.h::encryptModeFinal" ref="a0ccb05403a59b12490380f57c20d72ff" args="(ENCRYPT_MODE_CONTEXT *ctx, CIPHER_PRIMITIVE_CONTEXT *cipher, unsigned char *out, size_t *outlen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="encrypt_8h.html#a0ccb05403a59b12490380f57c20d72ff">encryptModeFinal</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_e_n_c_r_y_p_t___m_o_d_e___c_o_n_t_e_x_t.html">ENCRYPT_MODE_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_c_i_p_h_e_r___p_r_i_m_i_t_i_v_e___c_o_n_t_e_x_t.html">CIPHER_PRIMITIVE_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>outlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function finalizes an encryption mode context, and will process and return any leftover plaintext or ciphertext. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The encryption mode context to use. This context must have been allocated and initialized. </td></tr>
    <tr><td class="paramname">cipher</td><td>The cipher primitive context to use. </td></tr>
    <tr><td class="paramname">out</td><td>This points to a buffer which will contain any remaining plaintext (or ciphertext). </td></tr>
    <tr><td class="paramname">outlen</td><td>This points to a variable which will contain the number of bytes written to out. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Returns <code>ORDO_ESUCCESS</code> on success, and a negative value on error. </dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Once this function returns, the passed context can no longer be used for encryption or decryption. </dd>
<dd>
If padding is disabled, and the mode of operation is a block mode, this function will fail if there is any unprocessed data left in the context. </dd>
<dd>
If padding is disabled, or there is no padding in the mode of operation associated with the encryption context, this function returns no additional data. </dd>
<dd>
If padding is enabled, out should have space to hold at most one additional block of data (cipher primitive's block size), and at least one byte of data. </dd></dl>

</div>
</div>
<a class="anchor" id="ada8e8c1933363578b573bb270a78fa22"></a><!-- doxytag: member="encrypt.h::encryptModeFree" ref="ada8e8c1933363578b573bb270a78fa22" args="(ENCRYPT_MODE_CONTEXT *ctx, CIPHER_PRIMITIVE_CONTEXT *cipher)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="encrypt_8h.html#ada8e8c1933363578b573bb270a78fa22">encryptModeFree</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_e_n_c_r_y_p_t___m_o_d_e___c_o_n_t_e_x_t.html">ENCRYPT_MODE_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_c_i_p_h_e_r___p_r_i_m_i_t_i_v_e___c_o_n_t_e_x_t.html">CIPHER_PRIMITIVE_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>cipher</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function frees (deallocates) an initialized encryption mode context. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The encryption context to be freed. This context needs to at least have been allocated. </td></tr>
    <tr><td class="paramname">cipher</td><td>The cipher primitive context to use. </td></tr>
  </table>
  </dd>
</dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Once this function returns, the passed context may no longer be used anywhere and sensitive information will be wiped. Do not call this function if <code>encryptModeCreate</code> failed, as the latter correctly frees dangling context buffers in case of error. </dd></dl>

</div>
</div>
<a class="anchor" id="a4383b4295ff553f245623483fa17b5ba"></a><!-- doxytag: member="encrypt.h::encryptCreate" ref="a4383b4295ff553f245623483fa17b5ba" args="(CIPHER_PRIMITIVE *primitive, ENCRYPT_MODE *mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_e_n_c_r_y_p_t_i_o_n___c_o_n_t_e_x_t.html">ENCRYPTION_CONTEXT</a>* <a class="el" href="encrypt_8h.html#a4383b4295ff553f245623483fa17b5ba">encryptCreate</a> </td>
          <td>(</td>
          <td class="paramtype">CIPHER_PRIMITIVE *&#160;</td>
          <td class="paramname"><em>primitive</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ENCRYPT_MODE *&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function returns an allocated encryption context using a specific primitive and mode of operation. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">primitive</td><td>The primitive object to be used. </td></tr>
    <tr><td class="paramname">mode</td><td>The mode of operation object to be used. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Returns the allocated encryption context, or 0 if an allocation error occurred. </dd></dl>

</div>
</div>
<a class="anchor" id="a4fb43e9f859010383ff272dc19474c6a"></a><!-- doxytag: member="encrypt.h::encryptInit" ref="a4fb43e9f859010383ff272dc19474c6a" args="(ENCRYPTION_CONTEXT *ctx, void *key, size_t keySize, void *iv, void *cipherParams, void *modeParams, int direction)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="encrypt_8h.html#a4fb43e9f859010383ff272dc19474c6a">encryptInit</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_e_n_c_r_y_p_t_i_o_n___c_o_n_t_e_x_t.html">ENCRYPTION_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keySize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cipherParams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>modeParams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function initializes an encryption context for encryption, provided a key, initialization vector, and cipher/mode-specific parameters. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>An allocated encryption context. </td></tr>
    <tr><td class="paramname">key</td><td>A pointer to a buffer containing the key to use for encryption. </td></tr>
    <tr><td class="paramname">keySize</td><td>The size, in bytes, of the encryption key. </td></tr>
    <tr><td class="paramname">iv</td><td>This points to the initialization vector. Note the length of the initialization vector is known to be the same as the block size of the cipher primitive associated with the provided encryption context. </td></tr>
    <tr><td class="paramname">cipherParams</td><td>This points to specific cipher parameters, set to zero for default behavior. </td></tr>
    <tr><td class="paramname">modeParams</td><td>This points to specific mode of operation parameters, set to zero for default behavior. </td></tr>
    <tr><td class="paramname">direction</td><td>This represents the direction of encryption, set to 1 for encryption and 0 for decryption. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Returns <code>ORDO_ESUCCESS</code> on success, and a negative value on error. </dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>The initialization vector may be zero, if the mode of operation does not require one. </dd></dl>

</div>
</div>
<a class="anchor" id="a413d2b02feb780526dc5f52dba2fbefe"></a><!-- doxytag: member="encrypt.h::encryptUpdate" ref="a413d2b02feb780526dc5f52dba2fbefe" args="(ENCRYPTION_CONTEXT *ctx, unsigned char *in, size_t inlen, unsigned char *out, size_t *outlen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="encrypt_8h.html#a413d2b02feb780526dc5f52dba2fbefe">encryptUpdate</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_e_n_c_r_y_p_t_i_o_n___c_o_n_t_e_x_t.html">ENCRYPTION_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>inlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>outlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function encrypts or decrypts a buffer of a given length using the provided encryption context. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The encryption context to use. This context must have been allocated and initialized. </td></tr>
    <tr><td class="paramname">in</td><td>This points to a buffer containing plaintext (or ciphertext). </td></tr>
    <tr><td class="paramname">inlen</td><td>This contains the size of the in buffer, in bytes. </td></tr>
    <tr><td class="paramname">out</td><td>This points to a buffer which will contain the plaintext (or ciphertext). </td></tr>
    <tr><td class="paramname">outlen</td><td>This points to a variable which will contain the number of bytes written to out. </td></tr>
  </table>
  </dd>
</dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>See <code>encryptModeUpdate</code> remarks about output buffer size. </dd></dl>

</div>
</div>
<a class="anchor" id="a6531497a158f60683a99ccdd27da4d05"></a><!-- doxytag: member="encrypt.h::encryptFinal" ref="a6531497a158f60683a99ccdd27da4d05" args="(ENCRYPTION_CONTEXT *ctx, unsigned char *out, size_t *outlen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="encrypt_8h.html#a6531497a158f60683a99ccdd27da4d05">encryptFinal</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_e_n_c_r_y_p_t_i_o_n___c_o_n_t_e_x_t.html">ENCRYPTION_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>outlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function finalizes an encryption context, and will process and return any leftover plaintext or ciphertext. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The encryption context to use. This context must have been allocated and initialized. </td></tr>
    <tr><td class="paramname">out</td><td>This points to a buffer which will contain any remaining plaintext (or ciphertext). </td></tr>
    <tr><td class="paramname">outlen</td><td>This points to a variable which will contain the number of bytes written to out. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Returns <code>ORDO_ESUCCESS</code> on success, and a negative value on error. </dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Once this function returns, the passed context can no longer be used for encryption or decryption. </dd>
<dd>
See <code>encryptModeFinal</code> remarks. </dd></dl>

</div>
</div>
<a class="anchor" id="a7280c0420eb580d9ccd49ef0ab0956d7"></a><!-- doxytag: member="encrypt.h::encryptFree" ref="a7280c0420eb580d9ccd49ef0ab0956d7" args="(ENCRYPTION_CONTEXT *ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="encrypt_8h.html#a7280c0420eb580d9ccd49ef0ab0956d7">encryptFree</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_e_n_c_r_y_p_t_i_o_n___c_o_n_t_e_x_t.html">ENCRYPTION_CONTEXT</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function frees (deallocates) an initialized encryption context. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The encryption context to be freed. This context needs to at least have been allocated. </td></tr>
  </table>
  </dd>
</dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Once this function returns, the passed context may no longer be used anywhere and sensitive information will be wiped. Do not call this function if <code>encryptCreate</code> failed, as the latter correctly frees dangling context buffers in case of error. </dd></dl>

</div>
</div>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Mon Sep 10 2012 08:10:56 for Ordo by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
